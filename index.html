
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ryan's Poetic and Literary Insights</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Georgia', serif; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:#333; line-height:1.6; min-height:100vh; }
.container { max-width:1200px; margin:0 auto; padding:20px; }
header { text-align:center; padding:60px 20px; color:white; }
header h1 { font-size:3.5em; margin-bottom:10px; }
header p { font-size:1.3em; opacity:0.9; }
.admin-btn { position:fixed; top:20px; right:20px; padding:10px 20px; background:rgba(255,255,255,0.2); border:2px solid white; color:white; cursor:pointer; border-radius:25px; z-index:100; }
nav { display:flex; justify-content:center; gap:20px; margin:30px 0; }
.nav-btn { padding:12px 30px; background:rgba(255,255,255,0.2); border:2px solid white; color:white; cursor:pointer; border-radius:30px; }
.nav-btn.active { background:white; color:#667eea; }
.posts-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(350px,1fr)); gap:30px; }
.post-card { background:white; border-radius:15px; padding:30px; box-shadow:0 10px 30px rgba(0,0,0,0.2); cursor:pointer; }
.post-card.poem { font-style:italic; background:#ffecd2; }
.modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:2000; justify-content:center; align-items:center; }
.modal.active { display:flex; }
.modal-content { background:white; padding:40px; border-radius:20px; width:100%; max-width:600px; }
.form-group { margin-bottom:20px; }
.form-group label { font-weight:bold; display:block; margin-bottom:8px; }
.form-group input, textarea, select { width:100%; padding:12px; border-radius:8px; border:2px solid #ddd; font-family:inherit; }
textarea { min-height:200px; }
.btn-group { display:flex; gap:15px; margin-top:20px; }
.btn { padding:15px; border-radius:8px; cursor:pointer; border:none; }
.btn-primary { background:#667eea; color:white; }
.btn-secondary { background:#ddd; }
.btn-danger { background:#e74c3c; color:white; }
.add-post-btn { position:fixed; bottom:40px; right:40px; width:60px; height:60px; background:#667eea; color:white; border-radius:50%; font-size:2em; border:none; cursor:pointer; display:none; z-index:1000; }
.success, .error { position:fixed; top:20px; left:50%; transform:translateX(-50%); padding:15px; border-radius:8px; color:white; z-index:3000; }
.success { background:#2ecc71; }
.error { background:#e74c3c; }
</style>
</head>
<body>

<button class="admin-btn" onclick="toggleAdmin()">Admin</button>

<div class="container">
<header>
<h1>Ryan's Poetic and Literary Insights</h1>
<p>A collection of thoughts, stories, and poetry</p>
</header>

<nav>
<button class="nav-btn active" onclick="filterPosts('all', event)">All</button>
<button class="nav-btn" onclick="filterPosts('article', event)">Articles</button>
<button class="nav-btn" onclick="filterPosts('poem', event)">Poems</button>
</nav>

<div id="posts-container" class="posts-grid">
<div class="loading">Loading posts...</div>
</div>
</div>

<div id="admin-modal" class="modal">
<div class="modal-content">
<h2 id="modal-title"></h2>
<div id="modal-body"></div>
</div>
</div>

<button id="add-btn" class="add-post-btn" onclick="openAddPost()">+</button>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const SUPABASE_URL = "https://zqmgtnnwrceagkshfapq.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpxbWd0bm53cmNlYWdrc2hmYXBxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY3MDI2ODgsImV4cCI6MjA4MjI3ODY4OH0.Ql5KP6nfOSRzz1Z2eyN6WTqDsfVwZ0e9GKIbePa9eZE";

// FIX: Use window.supabase instead of just supabase
const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

let isAdmin = false;
let allPosts = [];
let currentFilter = "all";

async function loadPosts() {
    const { data, error } = await sb.from("posts").select("*").order("created_at",{ascending:false});
    if(error){ 
        console.error(error); 
        document.getElementById("posts-container").innerHTML="<div class='error'>Error loading posts. Make sure table exists in Supabase.</div>"; 
        return; 
    }
    allPosts = data || [];
    displayPosts();
}

function displayPosts() {
    const container = document.getElementById("posts-container");
    const posts = currentFilter==="all"?allPosts:allPosts.filter(p=>p.type===currentFilter);
    if(posts.length===0){ 
        container.innerHTML="<div style='color:white;text-align:center;padding:50px;'>No posts yet. "+(isAdmin?"Click + to add posts!":"Check back soon!")+"</div>"; 
        return; 
    }
    container.innerHTML = posts.map(p=>`
        <div class="post-card ${p.type==="poem"?"poem":""}">
            <h3>${p.title}</h3>
            <div style="color:#999;font-size:0.9em;margin:10px 0;">${new Date(p.created_at).toLocaleDateString()}</div>
            <p style="color:#666;">${p.content.substring(0,150)}${p.content.length>150?"...":""}</p>
            ${isAdmin?`<div class="btn-group" style="margin-top:15px;">
                <button class="btn btn-secondary" onclick="event.stopPropagation();openEditPost('${p.id}')">Edit</button>
                <button class="btn btn-danger" onclick="event.stopPropagation();deletePost('${p.id}')">Delete</button>
            </div>`:""}
        </div>
    `).join("");
}

function filterPosts(type,event){
    currentFilter=type;
    document.querySelectorAll(".nav-btn").forEach(b=>b.classList.remove("active"));
    event.target.classList.add("active");
    displayPosts();
}

function toggleAdmin(){
    if(isAdmin){
        sb.auth.signOut().then(()=>{ 
            isAdmin=false;
            document.querySelector(".admin-btn").textContent="Admin";
            document.getElementById("add-btn").style.display="none";
            displayPosts();
            showMessage("Logged out", "success");
        });
    } else showLogin();
}

function showLogin(){
    document.getElementById("modal-title").textContent="Admin Login";
    document.getElementById("modal-body").innerHTML=`
        <div class="form-group">
            <label>Email</label>
            <input id="email" type="email" placeholder="your-email@example.com">
        </div>
        <div class="form-group">
            <label>Password</label>
            <input id="password" type="password" placeholder="Enter password">
        </div>
        <div class="btn-group">
            <button class="btn btn-primary" onclick="login()">Login</button>
            <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
        </div>
    `;
    document.getElementById("admin-modal").classList.add("active");
}

async function login(){
    const email=document.getElementById("email").value;
    const password=document.getElementById("password").value;
    
    if(!email || !password){
        showMessage("Enter email and password", "error");
        return;
    }
    
    const { data, error } = await sb.auth.signInWithPassword({email,password});
    if(error){ 
        showMessage(error.message, "error");
        return; 
    }
    isAdmin=true;
    document.querySelector(".admin-btn").textContent="Logout";
    document.getElementById("add-btn").style.display="block";
    closeModal();
    displayPosts();
    showMessage("Logged in successfully!", "success");
}

function openAddPost(){
    document.getElementById("modal-title").textContent="Create New Post";
    document.getElementById("modal-body").innerHTML=`
        <div class="form-group">
            <label>Type</label>
            <select id="post-type">
                <option value="article">Article</option>
                <option value="poem">Poem</option>
            </select>
        </div>
        <div class="form-group">
            <label>Title</label>
            <input id="post-title" type="text" placeholder="Enter title...">
        </div>
        <div class="form-group">
            <label>Content</label>
            <textarea id="post-content" placeholder="Write your content here..."></textarea>
        </div>
        <div class="btn-group">
            <button class="btn btn-primary" onclick="savePost()">Publish</button>
            <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
        </div>
    `;
    document.getElementById("admin-modal").classList.add("active");
}

async function savePost(){
    const type=document.getElementById("post-type").value;
    const title=document.getElementById("post-title").value;
    const content=document.getElementById("post-content").value;
    
    if(!title||!content){ 
        showMessage("Title and content required", "error");
        return; 
    }
    
    const { error } = await sb.from("posts").insert({
        type:type,
        title:title,
        content:content,
        created_at:new Date().toISOString()
    });
    
    if(error){
        showMessage(error.message, "error");
        return;
    }
    
    closeModal();
    showMessage("Post published!", "success");
    loadPosts();
}

function openEditPost(id){
    const p = allPosts.find(x=>x.id===id);
    if(!p) return;
    
    document.getElementById("modal-title").textContent="Edit Post";
    document.getElementById("modal-body").innerHTML=`
        <div class="form-group">
            <label>Type</label>
            <select id="edit-type">
                <option value="article" ${p.type==="article"?"selected":""}>Article</option>
                <option value="poem" ${p.type==="poem"?"selected":""}>Poem</option>
            </select>
        </div>
        <div class="form-group">
            <label>Title</label>
            <input id="edit-title" type="text" value="${p.title.replace(/"/g, '&quot;')}">
        </div>
        <div class="form-group">
            <label>Content</label>
            <textarea id="edit-content">${p.content.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</textarea>
        </div>
        <div class="btn-group">
            <button class="btn btn-primary" onclick="updatePost('${id}')">Update</button>
            <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
        </div>
    `;
    document.getElementById("admin-modal").classList.add("active");
}

async function updatePost(id){
    const type=document.getElementById("edit-type").value;
    const title=document.getElementById("edit-title").value;
    const content=document.getElementById("edit-content").value;
    
    if(!title||!content){ 
        showMessage("Title and content required", "error");
        return; 
    }
    
    const { error } = await sb.from("posts").update({
        type:type,
        title:title,
        content:content
    }).eq("id",id);
    
    if(error){
        showMessage(error.message, "error");
        return;
    }
    
    closeModal();
    showMessage("Post updated!", "success");
    loadPosts();
}

async function deletePost(id){
    if(!confirm("Delete this post?")) return;
    
    const { error } = await sb.from("posts").delete().eq("id",id);
    
    if(error){
        showMessage(error.message, "error");
        return;
    }
    
    showMessage("Post deleted", "success");
    loadPosts();
}

function closeModal(){ 
    document.getElementById("admin-modal").classList.remove("active"); 
}

function showMessage(text, type){
    const msg = document.createElement("div");
    msg.className = type;
    msg.textContent = text;
    msg.style.position = "fixed";
    msg.style.top = "20px";
    msg.style.left = "50%";
    msg.style.transform = "translateX(-50%)";
    msg.style.padding = "15px 30px";
    msg.style.borderRadius = "8px";
    msg.style.color = "white";
    msg.style.zIndex = "3000";
    document.body.appendChild(msg);
    setTimeout(() => msg.remove(), 3000);
}

document.getElementById("admin-modal").addEventListener("click",function(e){ 
    if(e.target===this) closeModal(); 
});

loadPosts();
</script>
</body>
</html>




  
       
          
       
     

     


     




