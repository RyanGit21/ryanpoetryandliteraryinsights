<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ryan's Poetic and Literary Insights</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Georgia',serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#333;line-height:1.6;min-height:100vh}
.container{max-width:1200px;margin:0 auto;padding:20px}
header{text-align:center;padding:60px 20px;color:white}
header h1{font-size:3.5em;margin-bottom:10px}
header p{font-size:1.3em;opacity:.9}
.admin-btn{position:fixed;top:20px;right:20px;padding:10px 20px;background:rgba(255,255,255,.2);border:2px solid white;color:white;cursor:pointer;border-radius:25px;z-index:100}
nav{display:flex;justify-content:center;gap:20px;margin:30px 0}
.nav-btn{padding:12px 30px;background:rgba(255,255,255,.2);border:2px solid white;color:white;cursor:pointer;border-radius:30px}
.nav-btn.active{background:white;color:#667eea}
.posts-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:30px}
.post-card{background:white;border-radius:15px;padding:30px;box-shadow:0 10px 30px rgba(0,0,0,.2)}
.post-card.poem{font-style:italic;background:#ffecd2}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.8);z-index:2000}
.modal.active{display:flex;justify-content:center;align-items:center}
.modal-content{background:white;padding:40px;border-radius:20px;width:100%;max-width:600px}
.btn-group{display:flex;gap:15px}
.btn{padding:15px;border-radius:8px;cursor:pointer;border:none}
.btn-primary{background:#667eea;color:white}
.btn-secondary{background:#ddd}
.btn-danger{background:#e74c3c;color:white}
.add-post-btn{position:fixed;bottom:40px;right:40px;width:60px;height:60px;background:#667eea;color:white;border-radius:50%;font-size:2em;border:none;cursor:pointer;display:none}
.success,.error{position:fixed;top:20px;left:50%;transform:translateX(-50%);padding:15px;border-radius:8px;color:white;z-index:3000}
.success{background:#2ecc71}
.error{background:#e74c3c}
</style>
</head>
<body>

<button class="admin-btn" onclick="toggleAdmin()">Admin</button>

<div class="container">
<header>
<h1>Ryan's Poetic and Literary Insights</h1>
<p>A collection of thoughts, stories, and poetry</p>
</header>

<nav>
<button class="nav-btn active" data-filter="all">All</button>
<button class="nav-btn" data-filter="article">Articles</button>
<button class="nav-btn" data-filter="poem">Poems</button>
</nav>

<div id="posts-container" class="posts-grid"></div>
</div>

<div id="admin-modal" class="modal">
<div class="modal-content">
<h2 id="modal-title"></h2>
<div id="modal-body"></div>
</div>
</div>

<button id="add-btn" class="add-post-btn">+</button>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const SUPABASE_URL="https://zqmgtnnwrceagkshfapq.supabase.co";
const SUPABASE_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpxbWd0bm53cmNlYWdrc2hmYXBxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY3MDI2ODgsImV4cCI6MjA4MjI3ODY4OH0.Ql5KP6nfOSRzz1Z2eyN6WTqDsfVwZ0e9GKIbePa9eZE";
const supabase = supabase.createClient(SUPABASE_URL,SUPABASE_KEY);

let isAdmin=false, allPosts=[], currentFilter="all";

/* AUTH PERSISTENCE */
supabase.auth.onAuthStateChange((_e, session)=>{
isAdmin=!!session;
document.querySelector(".admin-btn").textContent=isAdmin?"Logout":"Admin";
document.getElementById("add-btn").style.display=isAdmin?"block":"none";
loadPosts();
});

/* LOAD POSTS */
async function loadPosts(){
try{
const {data,error}=await supabase.from("posts").select("*").order("created_at",{ascending:false});
if(error) throw error;
allPosts=data||[];
displayPosts();
}catch(e){showError("Failed to load posts");}
}

/* DISPLAY POSTS */
function displayPosts(){
const container=document.getElementById("posts-container");
const posts=currentFilter==="all"?allPosts:allPosts.filter(p=>p.type===currentFilter);
if(posts.length===0){container.innerHTML="<p>No posts yet.</p>";return;}
container.innerHTML=posts.map(p=>`
<div class="post-card ${p.type==="poem"?"poem":""}">
<h3>${p.title}</h3>
<p>${p.content.substring(0,150)}${p.content.length>150?"...":""}</p>
${isAdmin?`<div class="btn-group">
<button class="btn btn-secondary" onclick="openEditPost('${p.id}')">Edit</button>
<button class="btn btn-danger" onclick="deletePost('${p.id}')">Delete</button>
</div>`:""}
</div>
`).join("");
}

/* FILTER */
document.querySelectorAll(".nav-btn").forEach(b=>{
b.addEventListener("click",()=>{currentFilter=b.dataset.filter;document.querySelectorAll(".nav-btn").forEach(x=>x.classList.remove("active"));b.classList.add("active");displayPosts();});
});

/* ADMIN LOGIN/LOGOUT */
function toggleAdmin(){isAdmin?supabase.auth.signOut():showLogin();}
function showLogin(){
document.getElementById("modal-title").textContent="Admin Login";
document.getElementById("modal-body").innerHTML=`
<input id="email" placeholder="Email"><br><br>
<input id="password" type="password" placeholder="Password"><br><br>
<button class="btn btn-primary" id="login-btn">Login</button>`;
document.getElementById("admin-modal").classList.add("active");
document.getElementById("login-btn").addEventListener("click",login);
}
async function login(){
const email=document.getElementById("email").value;
const password=document.getElementById("password").value;
const {error}=await supabase.auth.signInWithPassword({email,password});
if(error){showError(error.message);return;}
closeModal();showSuccess("Logged in");
}

/* CREATE POST */
document.getElementById("add-btn").addEventListener("click",openAddPost);
function openAddPost(){
document.getElementById("modal-title").textContent="New Post";
document.getElementById("modal-body").innerHTML=`
<select id="type"><option value="article">article</option><option value="poem">poem</option></select><br><br>
<input id="title" placeholder="Title"><br><br>
<textarea id="content" placeholder="Content"></textarea><br><br>
<button class="btn btn-primary" id="save-btn">Publish</button>`;
document.getElementById("modal-body").querySelector("#save-btn").addEventListener("click",savePost);
document.getElementById("admin-modal").classList.add("active");
}
async function savePost(){
const type=document.getElementById("type").value;
const title=document.getElementById("title").value;
const content=document.getElementById("content").value;
const {error}=await supabase.from("posts").insert({type,title,content,created_at:new Date().toISOString()});
if(error){showError(error.message);return;}
closeModal();showSuccess("Post saved");loadPosts();
}

/* EDIT POST */
function openEditPost(id){
const p=allPosts.find(x=>x.id===id);
document.getElementById("modal-title").textContent="Edit Post";
document.getElementById("modal-body").innerHTML=`
<select id="type"><option value="article" ${p.type==="article"?"selected":""}>article</option><option value="poem" ${p.type==="poem"?"selected":""}>poem</option></select><br><br>
<input id="title" value="${p.title}"><br><br>
<textarea id="content">${p.content}</textarea><br><br>
<button class="btn btn-primary" id="update-btn">Update</button>`;
document.getElementById("modal-body").querySelector("#update-btn").addEventListener("click",()=>updatePost(id));
document.getElementById("admin-modal").classList.add("active");
}
async function updatePost(id){
const type=document.getElementById("type").value;
const title=document.getElementById("title").value;
const content=document.getElementById("content").value;
const {error}=await supabase.from("posts").update({type,title,content}).eq("id",id);
if(error){showError(error.message);return;}
closeModal();showSuccess("Updated");loadPosts();
}

/* DELETE */
async function deletePost(id){
if(!confirm("Delete post?")) return;
const {error}=await supabase.from("posts").delete().eq("id",id);
if(error){showError(error.message);return;}
showSuccess("Deleted");loadPosts();
}

/* MODAL */
function closeModal(){document.getElementById("admin-modal").classList.remove("active");}

/* TOASTS */
function showSuccess(msg){const d=document.createElement("div");d.className="success";d.textContent=msg;document.body.appendChild(d);setTimeout(()=>d.remove(),3000);}
function showError(msg){const d=document.createElement("div");d.className="error";d.textContent=msg;document.body.appendChild(d);setTimeout(()=>d.remove(),3000);}

document.getElementById("admin-modal").addEventListener("click",e=>{if(e.target===document.getElementById("admin-modal"))closeModal();});

</script>
</body>
</html>
  
       
          
       
     

     


     


